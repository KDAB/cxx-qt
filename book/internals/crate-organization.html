<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Crate Organization - CXX-Qt Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../getting-started/index.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting-started/1-qobjects-in-rust.html"><strong aria-hidden="true">2.1.</strong> QObjects in Rust</a></li><li class="chapter-item expanded "><a href="../getting-started/2-our-first-cxx-qt-module.html"><strong aria-hidden="true">2.2.</strong> Our first CXX-Qt module</a></li><li class="chapter-item expanded "><a href="../getting-started/3-qml-gui.html"><strong aria-hidden="true">2.3.</strong> Creating the QML GUI</a></li><li class="chapter-item expanded "><a href="../getting-started/4-cargo-executable.html"><strong aria-hidden="true">2.4.</strong> Building with Cargo</a></li><li class="chapter-item expanded "><a href="../getting-started/5-cmake-integration.html"><strong aria-hidden="true">2.5.</strong> Building with CMake</a></li></ol></li><li class="chapter-item expanded "><a href="../concepts/index.html"><strong aria-hidden="true">3.</strong> Core Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../concepts/build_systems.html"><strong aria-hidden="true">3.1.</strong> Build Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../concepts/wasm-builds.html"><strong aria-hidden="true">3.1.1.</strong> Building for WebAssembly</a></li></ol></li><li class="chapter-item expanded "><a href="../concepts/generated_qobject.html"><strong aria-hidden="true">3.2.</strong> Generated QObject</a></li><li class="chapter-item expanded "><a href="../concepts/types.html"><strong aria-hidden="true">3.3.</strong> Types</a></li><li class="chapter-item expanded "><a href="../concepts/nested_objects.html"><strong aria-hidden="true">3.4.</strong> Nested Objects</a></li><li class="chapter-item expanded "><a href="../concepts/inheritance.html"><strong aria-hidden="true">3.5.</strong> Inheritance & Overriding</a></li></ol></li><li class="chapter-item expanded "><a href="../bridge/index.html"><strong aria-hidden="true">4.</strong> Reference: the bridge module</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bridge/extern_rustqt.html"><strong aria-hidden="true">4.1.</strong> extern "RustQt"</a></li><li class="chapter-item expanded "><a href="../bridge/extern_cppqt.html"><strong aria-hidden="true">4.2.</strong> extern "C++Qt"</a></li><li class="chapter-item expanded "><a href="../bridge/shared_types.html"><strong aria-hidden="true">4.3.</strong> Shared types</a></li><li class="chapter-item expanded "><a href="../bridge/attributes.html"><strong aria-hidden="true">4.4.</strong> Attributes</a></li><li class="chapter-item expanded "><a href="../bridge/traits.html"><strong aria-hidden="true">4.5.</strong> Traits</a></li></ol></li><li class="chapter-item expanded "><a href="../internals/index.html"><strong aria-hidden="true">5.</strong> For Contributors: CXX-Qt Internals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../internals/build-system.html"><strong aria-hidden="true">5.1.</strong> Build System</a></li><li class="chapter-item expanded "><a href="../internals/crate-organization.html" class="active"><strong aria-hidden="true">5.2.</strong> Crate Organization</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CXX-Qt Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!--
SPDX-FileCopyrightText: 2024 Klarälvdalens Datakonsult AB, a KDAB Group company <info@kdab.com>
SPDX-FileContributor: Leon Matthes <leon.matthes@kdab.com>

SPDX-License-Identifier: MIT OR Apache-2.0
-->
<h1 id="crate-organization"><a class="header" href="#crate-organization">Crate Organization</a></h1>
<p>CXX-Qt is made up of multiple crates under the <code>crates/</code> directory.</p>
<p>This page lays out the goal of each crate and how it is differentiated from the other crates.</p>
<ul>
<li><a href="#cxx-qt">⭐ <code>cxx-qt</code> - The Star of the Show</a></li>
<li><a href="#cxx-qt-build">👷 <code>cxx-qt-build</code> - The Construction Worker</a></li>
<li><a href="#cxx-qt-gen">💚 <code>cxx-qt-gen</code> - The Heart of CXX-Qt</a></li>
<li><a href="#cxx-qt-lib">📖 <code>cxx-qt-lib</code> - The &quot;standard&quot; Library</a></li>
<li><a href="#cxx-qt-lib-extras">📚 <code>cxx-qt-lib-extras</code> - The Bookshelf</a></li>
<li><a href="#cxx-qt-macro">💻 <code>cxx-qt-macro</code> - Frontend for cxx-qt-gen</a></li>
<li><a href="#qt-build-utils">🦾 <code>qt-build-utils</code> - Building with Qt</a></li>
<li><a href="#cxx-qt-cmake">🤝 <code>cxx-qt-cmake</code> - Handoff to CMake</a></li>
</ul>
<h1 id="-cxx-qt---the-star-of-the-show"><a class="header" href="#-cxx-qt---the-star-of-the-show"><a name="cxx-qt"></a>⭐ <code>cxx-qt</code> - The Star of the Show</a></h1>
<p>The main crate of CXX-Qt.</p>
<p>It serves as the actual crate our users should interface with.
Anything that our users have to name in their downstream crates should be accessible via this crate.
Mostly importantly this includes a re-export of the <code>#[cxx_qt::bridge]</code> macro from the <code>cxx-qt-macro</code> crate.
Additionally, any code that the bridge references after expansion lives in <code>cxx-qt</code>.</p>
<p>Limitation: The <code>cxx-qt</code> crate itself is limited to implementing a superset of CXX.
This means its goal is to add additional Qt-specific features to CXX.
Namely support for Qts Meta-Object-System, which includes QObjects, QEnums, properties, signals, slots, etc.</p>
<p>CXX-Qt aims to <strong>allow you</strong> to wrap Qt APIs and create your own Qt-compatible types.
It <strong>does not</strong> aim to actually wrap Qt API.
Apart from a few extremely basic types that are needed for this goal, wrapping the actual Qt API is delegated to <code>cxx-qt-lib</code> and <code>cxx-qt-lib-extras</code>.</p>
<p>This should also allow <code>cxx-qt-lib</code> and <code>cxx-qt-lib-extras</code> to be used without the user needing to use the <code>cxx-qt</code> crate itself, which is why they're explicitly seperated.</p>
<h1 id="-cxx-qt-build---the-construction-worker"><a class="header" href="#-cxx-qt-build---the-construction-worker"><a name="cxx-qt-build"></a> 👷 <code>cxx-qt-build</code> - The Construction Worker</a></h1>
<p><code>cxx-qt-build</code> provides the user-accessible API for building applications with CXX-Qt.</p>
<p>Specifically this means expanding and compiling the C++ code of each bridge.</p>
<p>In addition, it needs to integrate Qt into both Cargo and CMake.
For Cargo, it uses Cargos build-script features to instruct linking, etc.
For CMake, it exposes the required artifacts into a well-known directory and structure so that CMake can pick them up. The <code>cxx-qt-cmake</code> repo contains the CMake code to pick up the artifacts.</p>
<p>The access to Qts build tooling has actually been made available as a separate crate: <code>qt-build-utils</code>, which <code>cxx-qt-build</code> uses internally</p>
<h1 id="-cxx-qt-gen---the-heart-of-cxx-qt"><a class="header" href="#-cxx-qt-gen---the-heart-of-cxx-qt"><a name="cxx-qt-gen"></a> 💚 <code>cxx-qt-gen</code> - The Heart of CXX-Qt</a></h1>
<p>This crate contains the &quot;main functionality&quot; of CXX-Qt.</p>
<p>It encapsulates the transpiler that is at the very core of CXX-Qt.
As described in the <code>cxx-qt</code> crate section, the goal of CXX-Qt is primarily to serve as an extension to CXX, that allows users to express Qt-specific constructs.</p>
<p><code>cxx-qt-gen</code> implements the necessary transpiler that transpiles from a <code>#[cxx_qt::bridge]</code> to a <code>#[cxx::bridge]</code> and associated Rust and C++ code.</p>
<p>This transpiler is then used by the <code>#[cxx_qt::bridge]</code> macro via <code>cxx-qt-macro</code>, and also by <code>cxx-qt-build</code> for the C++ code generation.</p>
<blockquote>
<p>⚠️  cxx-qt-gen should not be used directly, but only through <code>cxx-qt</code> and <code>cxx-qt-build</code></p>
<p>For this reason, cxx-qt-gen itself is semver-exempt!</p>
</blockquote>
<blockquote>
<p>TODO: Add a documentation of the cxx-qt-gen stages and architecture in a separate page</p>
</blockquote>
<h1 id="-cxx-qt-lib---the-standard-library"><a class="header" href="#-cxx-qt-lib---the-standard-library"><a name="cxx-qt-lib"></a> 📖 <code>cxx-qt-lib</code> - The &quot;standard&quot; Library</a></h1>
<p><code>cxx-qt-lib</code> is to <code>cxx-qt</code>, what Rusts <code>std</code> library is to <code>rustc</code>.</p>
<p>It includes high-quality wrappers for the most important Qt types.
These are often implemented in terms of plain <code>#[cxx::bridge]</code>s, with only a few types requiring <code>#[cxx_qt::bridges]</code>.</p>
<p>During the development of CXX-Qt, we quickly realised that high-quality bindings to the Qt API are best written by hand.
Especially for types that should be available as trivial types in Rust.
However, this often brought up the problem of maintenance workload.</p>
<p>Qt has a huge API surface.
For this reason we decided early on that wrapping all of Qts API is simply out-of-scope.
This is exactly why we set the focus of CXX-Qt to empower the user.
We want our users to be able to quickly access any part of the API they need by creating their own bindings.</p>
<p>However, without at least a few fundamental types, this is very hard to do.
<code>cxx-qt-lib</code> aims to close exactly this gap.
It's goal is to provide just enough types and API to provide a basis onto which new bindings can build.</p>
<p>Additional types can be added into a separate, less maintained, crate (namely: <code>cxx-qt-lib-extras</code>).</p>
<p>This leads us to the concrete policy for including types in <code>cxx-qt-lib</code>:</p>
<h2 id="cxx-qt-lib-inclusion-policy"><a class="header" href="#cxx-qt-lib-inclusion-policy"><code>cxx-qt-lib</code> inclusion policy</a></h2>
<ul>
<li>Default to adding anything you think may be useful to <code>cxx-qt-lib-extras</code></li>
<li>Only add types to <code>cxx-qt-lib</code> directly, if they're either:
<ul>
<li>Hard to wrap optimally (i.e. should be trivial/templates, etc.)</li>
<li>Often used as parameters/return values within the Qt codebase</li>
</ul>
</li>
</ul>
<p>We can then always promote types from -lib-extras to -lib, if/when it turns out this type is used regularly.</p>
<h1 id="-cxx-qt-lib-extras---the-bookshelf"><a class="header" href="#-cxx-qt-lib-extras---the-bookshelf"><a name="cxx-qt-lib-extras"></a> 📚 <code>cxx-qt-lib-extras</code> - The Bookshelf</a></h1>
<p>As mentioned in the <code>cxx-qt-lib</code> library, we do not aim to maintain wrappers for the entire Qt API.
However, it would still be useful to have a place where the community can share and collect bindings for whatever they have wrapped of the Qt API.</p>
<p>This is exactly what <code>cxx-qt-lib-extras</code> is for!
The details are outlined in <a href="https://github.com/KDAB/cxx-qt/issues/766">#766</a>.</p>
<p>The barrier of entry here is very low.
We will accept pretty much any PR, as long as:</p>
<blockquote>
<p>✅ It wraps part of the Qt API</p>
</blockquote>
<blockquote>
<p>✅ Compiles</p>
</blockquote>
<blockquote>
<p>✅ Isn't obviously broken in some other way</p>
</blockquote>
<p>However, we will not spend much (if any) time to actually maintain these bindings!</p>
<p>Specifically this means:</p>
<blockquote>
<p>⚠️  <code>cxx-qt-lib-extras</code> is semver-exempt!</p>
<p>Specifically, we may simply drop a binding from the crate if it causes issues.</p>
</blockquote>
<blockquote>
<p>⚠️  Bindings may be incomplete or undocumented!</p>
</blockquote>
<blockquote>
<p>⚠️  Memory Safety Errors and other issues are possible!</p>
</blockquote>
<p>Basically: There be dragons 🐉 - use at your own risk.</p>
<p>Forking of <code>cxx-qt-lib-extras</code> is encouraged to create something stable you can rely on for yourself.
Simply copying individual files out of the crate into your own crate is also a reasonable way of using -lib-extras.</p>
<p>We only ask that you contribute your own wrappers and fixes back to -lib-extras so the wider ecosystem can benefit.</p>
<h1 id="-cxx-qt-macro---frontend-for-cxx-qt-gen"><a class="header" href="#-cxx-qt-macro---frontend-for-cxx-qt-gen"><a name="cxx-qt-macro"></a> 💻 <code>cxx-qt-macro</code> - Frontend for cxx-qt-gen</a></h1>
<p>For technical reasons within Cargo, procedural macros need to be a special type of crate.</p>
<p><code>cxx-qt-macro</code> wraps the bridge macro, which is then re-exported by the <code>cxx-qt</code> crate.</p>
<h1 id="-qt-build-utils---building-with-qt"><a class="header" href="#-qt-build-utils---building-with-qt"><a name="qt-build-utils"></a> 🦾 <code>qt-build-utils</code> - Building with Qt</a></h1>
<p>This crate wraps Qts custom build tooling like moc.</p>
<p>It is mostly used by <code>cxx-qt-build</code>. But because it may be useful to other crates in the Qt ecosystem as well, we have decided to split it into its own crate.</p>
<h1 id="-cxx-qt-cmake---handoff-to-cmake"><a class="header" href="#-cxx-qt-cmake---handoff-to-cmake"><a name="cxx-qt-cmake"></a> 🤝 <a href="https://github.com/kdab/cxx-qt-cmake"><code>cxx-qt-cmake</code></a> - Handoff to CMake</a></h1>
<p>Whilst this is not a crate, it's a separate &quot;project&quot;, as it lives in another repository.
<code>cxx-qt-cmake</code> simply contains the bits of CMake code that encapsulate the integration of <code>cxx-qt-build</code> artifacts into CMake.</p>
<p>It lives inside a separate repository as that makes the use of CMakes <code>FetchContent</code> a lot faster as users don't have to download all of CXX-Qt.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../internals/build-system.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../internals/build-system.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
